<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Class: Gaia</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Class: Gaia</h1>

    




<section>

<header>
    
        <h2><span class="attribs"><span class="type-signature"></span></span>Gaia<span class="signature">()</span><span class="type-signature"></span></h2>
        
            <div class="class-description"><p>Collects information from each sprites into a unitary whole network state</p></div>
        
    
</header>

<article>
    <div class="container-overview">
    
        

    
    <h2>Constructor</h2>
    

    
    <h4 class="name" id="Gaia"><span class="type-signature"></span>new Gaia<span class="signature">()</span><span class="type-signature"></span></h4>
    

    















<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>




















    
    </div>

    

    

    
        <h3 class="subsection-title">Classes</h3>

        <dl>
            <dt><a href="Gaia.html">Gaia</a></dt>
            <dd></dd>
        </dl>
    

    

    

    

    
        <h3 class="subsection-title">Members</h3>

        
            
<h4 class="name" id="sprites"><span class="type-signature"></span>sprites<span class="type-signature"></span></h4>




<div class="description">
    <p>Object associating each sprite id to a payload</p>
</div>







<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>






        
            
<h4 class="name" id="urls"><span class="type-signature"></span>urls<span class="type-signature"></span></h4>




<div class="description">
    <p>Enpoints for http requests</p>
</div>







<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>






        
            
<h4 class="name" id="vibes"><span class="type-signature"></span>vibes<span class="type-signature"></span></h4>




<div class="description">
    <p>Object associating each sprite id to the ids of the sprites it is connected to</p>
</div>







<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>






        
    

    
        <h3 class="subsection-title">Methods</h3>

        
            

    

    
    <h4 class="name" id="handleImgRequest"><span class="type-signature">(async) </span>handleImgRequest<span class="signature">()</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    <p>Handles the request of a Gaia image</p>
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>




















        
            

    

    
    <h4 class="name" id="handleRequest"><span class="type-signature">(async) </span>handleRequest<span class="signature">()</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    <p>Dispatches the request to its own handler, depending on the req.url</p>
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>




















        
            

    

    
    <h4 class="name" id="img"><span class="type-signature"></span>img<span class="signature">(center<span class="signature-attributes">opt</span>, radius<span class="signature-attributes">opt</span>, sample<span class="signature-attributes">opt</span>, requireUrl<span class="signature-attributes">opt</span>)</span><span class="type-signature"> &rarr; {Object}</span></h4>
    

    



<div class="description">
    <p>ðŸ“¸ <strong>Takes a snapshot (img) of the current Gaia state.</strong></p>
<p>Produces a filtered and optionally sampled view of the current network,
returning only the sprites and vibes that meet the provided conditions.</p>
<hr>
<h3>Behavior</h3>
<ul>
<li>If both a geographic <code>center</code> (<code>[longitude, latitude]</code>) and a finite <code>radius</code> are provided,
only <strong>sprites within that circular region</strong> are included.</li>
<li>The result can be <strong>randomly sampled</strong> using <code>sample</code> to limit the number of sprites returned.
When the sample size is smaller than the total candidates, duplicates may occur,
so the actual number of unique sprites may be slightly smaller than requested.</li>
<li><strong>Vibe targets</strong> are not restricted to the selected sprites â€” only <strong>source sprites</strong> are filtered.</li>
<li>By default, all sprites are included (both servers and clients).
Set <code>requireUrl = true</code> to restrict the snapshot to only <strong>server-type sprites</strong>
(those exposing a <code>payload.url</code> property).</li>
</ul>
<hr>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        
        <th>Default</th>
        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>center</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array.&lt;number></span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                </td>
            

            <td class="description last"><p>Optional <code>[longitude, latitude]</code> defining the circleâ€™s center.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>radius</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                    Infinity
                
                </td>
            

            <td class="description last"><p>Optional radius (in meters) for geographic filtering.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>sample</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                    Infinity
                
                </td>
            

            <td class="description last"><p>Optional maximum number of sprites to include, randomly sampled.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>requireUrl</code></td>
            

            <td class="type">
            
                
<span class="param-type">boolean</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                    false
                
                </td>
            

            <td class="description last"><p>Whether to include <strong>only sprites with a defined <code>payload.url</code></strong>.</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>An object containing:
- <code>sprites</code>: Filtered or sampled sprite records.
- <code>vibes</code>: Outgoing vibes whose <strong>source</strong> sprites are among the selected ones.</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Object</span>


    </dd>
</dl>

    




    <h5>Examples</h5>
    
    <pre class="prettyprint"><code>// Get all sprites within 5km of a given locationconst snapshot = gaia.img([12.4924, 41.8902], 5000);</code></pre>

    <pre class="prettyprint"><code>// Get a random sample of up to 100 server-only sprites (requireUrl = true)const snapshot = gaia.img(undefined, Infinity, 100, true);</code></pre>

    <pre class="prettyprint"><code>// Full state dump (all sprites, clients + servers)const snapshot = gaia.img();</code></pre>



        
            

    

    
    <h4 class="name" id="resolveImgRequest"><span class="type-signature">(async) </span>resolveImgRequest<span class="signature">(ctx)</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    <p>Adds the client info (from the body) to this.img
Sends to the client the requested, updated, image</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>ctx</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            

            

            <td class="description last"><p>argument</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>




















        
            

    

    
    <h4 class="name" id=".dist"><span class="type-signature">(static) </span>dist<span class="signature">(a, b)</span><span class="type-signature"> &rarr; {number}</span></h4>
    

    



<div class="description">
    <p>Computes the great-circle distance (in meters) between two terrestrial points.
Each point is represented as an array <code>[longitude, latitude]</code> in degrees.</p>
<p>Uses the Haversine formula for accurate results on Earthâ€™s curvature.</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>a</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array.&lt;number></span>


            
            </td>

            

            

            <td class="description last"><p>First point <code>[longitude, latitude]</code></p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>b</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array.&lt;number></span>


            
            </td>

            

            

            <td class="description last"><p>Second point <code>[longitude, latitude]</code></p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>Distance in meters or NaN if some coordinate is undefined</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">number</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".imgQuery"><span class="type-signature">(static) </span>imgQuery<span class="signature">()</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    <p>Returns the query string for a Gaia image request.</p>
<p>Example: &quot;long=12.34&amp;lat=45.67&amp;radius=1000&amp;sample=50&quot;</p>
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>




















        
            

    

    
    <h4 class="name" id=".sample"><span class="type-signature">(static) </span>sample<span class="signature">(entries, n)</span><span class="type-signature"> &rarr; {Each.&lt;Array.&lt;*>>}</span></h4>
    

    



<div class="description">
    <p>Randomly selects up to <code>n</code> entries from the provided array.
Duplicates may occur because sampling is done with replacement.
The result is returned as an Each iterable of <code>[id, payload]</code> pairs.</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>entries</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array.&lt;Array.&lt;*>></span>


            
            </td>

            

            

            <td class="description last"><p>Array of <code>[id, payload]</code> pairs.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>n</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last"><p>Number of items to sample.</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>An <code>Each</code> iterable yielding sampled <code>[id, payload]</code> pairs.</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Each.&lt;Array.&lt;*>></span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".servers"><span class="type-signature">(static) </span>servers<span class="signature">(img)</span><span class="type-signature"> &rarr; {Each.&lt;string>}</span></h4>
    

    



<div class="description">
    <p>Returns an <code>Each</code> iterator over the IDs of all sprites that define a <code>url</code> property.</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>img</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            

            

            <td class="description last"><p>The Gaia image containing sprites.</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>An <code>Each</code> iterator of sprite IDs that have a URL.</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Each.&lt;string></span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".update"><span class="type-signature">(static) </span>update<span class="signature">(param0)</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    <p>Merges the provided img data into the current Gaia img.
Existing sprites and vibes are updated or extended in place.</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>param0</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            

            

            <td class="description last"><p>The new image data.</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>




















        
    

    

    
</article>

</section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="aura%250D-%2520%257B@link%2520GaiaAura%257D%250D-%2520%257B@link%2520HttpAura%257Dmodule_.html">aura- <a href="GaiaAura.html">GaiaAura</a>- <a href="HttpAura.html">HttpAura</a></a></li><li><a href="core%250D-%2520%257B@link%2520Aura%257D%250D-%2520%257B@link%2520Gaia%257D%250D-%2520%257B@link%2520Sprite%257D%250D-%2520%257B@link%2520Vibe%257Dmodule_.html">core- <a href="Aura.html">Aura</a>- <a href="Gaia.html">Gaia</a>- <a href="Sprite.html">Sprite</a>- <a href="Vibe.html">Vibe</a></a></li></ul><h3>Classes</h3><ul><li><a href="Aura.html">Aura</a></li><li><a href="Gaia.html">Gaia</a></li><li><a href="GaiaAura.html">GaiaAura</a></li><li><a href="HttpAura.html">HttpAura</a></li><li><a href="Node.html">Node</a></li><li><a href="Sprite.html">Sprite</a></li><li><a href="Vibe.html">Vibe</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.2</a> on Wed Oct 15 2025 16:45:57 GMT+0200 (Ora legale dellâ€™Europa centrale)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>